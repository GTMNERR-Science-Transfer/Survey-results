---
title: "Guana Estuary Data Dashboard Needs Assessment: Survey Results"
author: "Geraldine Klarenberg"
date: "2023-08-14"
output: 
  html_document:
    css: box_style.css
#output: pdf_document
---

#### DRAFT v2

##### Project: Using collaborative open science tools to improve engagement with the ecology of the Guana River Estuary
###### *Project team: Geraldine Klarenberg, Kristie Perez, Nikki Dix, Nia Morales, and Shirley Baker*

The University of Florida and Guana Tolomato Matanzas National Estuarine Research Reserve (GTMNERR) are partnering with the local community and broader science community to develop a web-based, public-facing, interactive dashboard to provide access to Guana Estuary datasets. The aim of this work is to support open science and to increase diverse engagement with the Guana Estuary within the GTMNERR by making the data available interactively, using visualization tools.

To this end, the project team sought feedback from those who have been involved with the Guana Estuary to help them to better understand their needs. This document summarizes the results of an online survey that was made available via email, social media, and QR code.

```{r load_package_data, echo = FALSE, message = FALSE}
library(tidyverse)
library(kableExtra)
library(cowplot)
library(formattable)

intro <- read_csv("../data_deidentified/subsets/intro_results_basic.csv")
no_access <- read_csv("../data_deidentified/subsets/data_no_results_basic.csv")
yes_data <- read_csv("../data_deidentified/subsets/data_yes_results_basic.csv")
dashboard <- read_csv("../data_deidentified/subsets/dashboard_results_basic.csv")
demogr <- read_csv("../data_deidentified/subsets/demographics_results_basic.csv")
```

### 1. Response rate
We received responses from 51 individuals. Out of these, 14 surveys were unfinished. For this report, we also took the unfinished surveys into account.

47 respondents filled in the survey based on a link received via email, 3 via social media, 0 via the QR code available at the GTMNERR Welcome Center, and 1 via the QR code available at the kiosk at the dam.

_____________________________________________________________

### 2. Introductory questions

The survey started with asking respondents about their connection to the Guana Estuary, how often they engage with the Guana Estuary, what data they would be interested in, and whether or not they ever accessed data associated with the Guana Estuary.

For the purposes of this project, and this survey, "Guana Estuary" refers to the Guana Lake and Guana River: the area north and south of the Guana Dam, from Micklers Road to the Tolomato River / intracoastal.

```{r num_respondents, echo = FALSE}
# Create variable with total number of respondents, to be used as annotation on plots
num_resp <- length(unique(intro$ID))
```

#### 2.1 Guana Estuary connection

We asked respondents about their connection with the Guana Estuary. The figure below summarizes the responses, but note that people could pick more than 1 option. This is why the sum of all percentages adds up to more than 100%. 

In total there were 111 connections chosen. E.g. a little over 60% of respondents do recreational activities at the Guana Estuary, and almost 50% collect data or use data for scientific purposes - and these choices are not mutually exclusive! Someone could collect data and *also* enjoy the Guana Estuary recreationally. Or volunteer and *also* use the Guana Estuary for educational purposes.

```{r connected, fig.width = 7, fig.height = 3, echo = FALSE, message = FALSE, fig.align = 'center'}
# count total number of answers
num_answers <- intro %>%
  filter(str_detect(qname, "D-1")) %>% 
  summarize(num_answers = n()) %>% 
  pull(num_answers)

ggplot(intro %>% 
         filter(str_detect(qname, "D-1")) %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp*100, 1)), #sum(cnt)
       aes(y = reorder(q_text, percentage), x = percentage, fill = q_text))+
  geom_col() +
  labs(y = "", x = paste0("Percentage of all respondents (N = ", num_resp, ")"), 
       title = "How are you connected to the Guana Estuary?",
       caption  = "NOTE: Respondents could pick more than 1 response") +
  scale_fill_viridis_d(option = "mako")+
  scale_y_discrete(labels = function(x) str_wrap(x, width = 50))+
  theme_bw()+
  theme(legend.position = "none",
        plot.title.position = "plot",
        plot.caption.position =  "plot",
        plot.caption = element_text(hjust = 0, face = "italic"))
```

Under "Other", respondents answered:

* Lake management - FWC
* Health
* GTM-NERR MAG member
* Sometimes bring international visitors for professional conversations (am retired now).

--------------------------------------------------------

#### 2.2 Level of engagement
```{r engage, fig.width = 4, fig.height = 3, echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center'}
ggplot(intro %>% 
         filter(qname == "D-2") %>% 
         mutate(q_text = fct_rev(factor(q_text, levels = c("Daily", "At least once a week",
                                                 "2-3 times a month", "Once a month",
                                                 "Once every 6 months", "Once every year",
                                                 "Less than once a year")))) %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/sum(cnt)*100, 1)), 
       aes(y = q_text,
           x = percentage,
           fill = cnt))+
  geom_col() +
  labs(x = paste0("Percentage of respondents (N = ", num_resp, ")"), 
       y = "", title = "How often do you engage with the Guana Estuary?") +
  scale_fill_distiller(palette = "GnBu", direction = 1)+
  theme_bw()+
  theme(legend.position = "none",
        plot.title.position = "plot")
```

--------------------------------------------------------

#### 2.3 Data of interest (in general)
We asked respondents what Guana Estuary data they would be interested in, regardless of whether or not they currently have access to these data. Respondents were also asked to rank these datasets, with 1 being the data they are most interested in. They could pick as many or few as they wanted.

The figure below shows the percentage of respondents that picked a particular dataset being of interest to them. E.g. over 80% of respondents picked water quality data. The colors indicate how they ranked it: for instance, almost 40% of all respondents ranked water quality data as their number 1 dataset of interest.

```{r what_data, fig.width = 7, fig.height = 6, echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center'}
ggplot(intro %>% 
         filter(str_detect(qname, "D-3")) %>% 
         group_by(q_text, order) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp*100, 1)) %>% 
         group_by(q_text) %>% 
         mutate(tot_perc = sum(percentage)),
       aes(y = reorder(q_text, tot_perc), x = percentage, fill = fct_rev(factor(order))))+
  geom_col() +
  labs(y = "", x = paste0("Percentage of respondents (N = ", num_resp, ")"), title = "What datasets are you interested in?") +
  scale_fill_viridis_d(option = "plasma", name = "Rank", direction = -1)+
  scale_y_discrete(labels = function(x) str_wrap(x, width = 50))+
  theme_bw()+
  theme(plot.title.position = "plot",
        legend.position = "top",
        legend.spacing.x = unit(0.5, 'cm'))+
  guides(fill = guide_legend(title = "Rank",
                             nrow = 1,
                             label.position = "bottom",
                             title.position = "left", title.vjust = 1,
                             reverse = TRUE))

# ggplot(intro %>% 
#          filter(str_detect(qname, "D-3")) %>% 
#          group_by(q_text) %>% summarize(ave_rank = mean(order, na.rm = TRUE)) %>% 
#          mutate(q_text = fct_reorder(q_text, ave_rank)),
#        aes(x = ave_rank, y = fct_rev(q_text))) +
#   geom_col(fill = "royalblue")+
#   scale_y_discrete(labels = function(x) str_wrap(x, width = 50))+
#   labs(y = "", x = "", subtitle = "What datasets are you interested in? (Average ranking: 1 = most interested in)")+
#   theme_bw()+
#   theme(plot.title.position = "plot")
```

Under "Other", the 4 types of datasets mentioned were: historical maps, water fowl, dam operations, natural resource management practices/techniques/results.


--------------------------------------------------------

#### 2.4 Previous experience with accessing data associated with Guana Estuary

The survey asked respondents whether they had accessed data before, and by "data", we meant "information, especially facts or numbers, collected to be examined and considered and used to help decision-making; or information in an electronic form that can be stored and used by a computer" for instance spreadsheets, databases, graphs, and maps." 

```{r accessed_data, fig.width = 4, fig.height = 3, echo = FALSE, message = FALSE, fig.align = 'center'}
ggplot(intro %>% 
         filter(qname == "D-4") %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/sum(cnt)*100, 1)),
       aes(x = q_text, y = percentage, fill = q_text))+
  geom_col() +
  labs(x = "", y = paste0("Percentage of respondents (N = ", num_resp, ")"),
       title = "Have you accessed data before?") +
  scale_fill_manual(values = c("chocolate1", "darkorchid2"))+
  theme_bw()+
  theme(legend.position = "none")
```

Based on their response whether or not they had accessed data, respondents answered different sets of questions. The results are summarized in the next two sections.

:::: {.infobox .info data-latex="{info}"}
**Take home message**

- The majority of respondents use the Guana Estuary recreationally (62.7%) and almost half (49%) collect or use data for scientific purposes. In third and fourth place are other work-related and educational connections (resp. 33.3% and 29.4%).
- Engagement with the Guana Estuary is mostly once a month (21.6% of respondents), with a tie (19.6%) for once a week and once every 6 months. Daily engagement was indicated by 17.6% of respondents. 
- The top 4 datasets of interest, chosen by more than 60% of the respondents, are: water quality information, information on shellfish, fish and other aquatic organisms, water level information, and information on vegetation. 
- The majority of respondents (83.7%) has accessed data before.

::::

___________________________________________________________

### 3. Feedback from respondents that had not accessed data before

For respondents that had not (yet) accessed data (N = 8), the figure below summarizes their answers from section 2.3 (datasets of interest). In this figure, the datasets are ordered according to their average ranking, once again 1 being the dataset of most interest.

This paints an interesting picture, as, for instance, water quality data were picked by most respondents, but in terms of average ranking it comes in 4th (3rd) place. Only one person responded they were not interested in any data ("None"), hence this item ranks first, as the average of 1 is 1... We can essentially disregard this item. The 3 datasets that score less than an average ranking of 3 are water level information, reserve or trail closures, and water quality information. However, information on vegetation, and information on fish, shellfish and other aquatic organisms was also picked by more than 60% (5 respondents) - but it was ranked lower on average.  

*These responses will still be linked to the answers in 2.3*
```{r link, echo = FALSE, message = FALSE}
# count total number of answers
num_resp_no_data <- length(unique(no_access$ID))

intro %>%
         filter(ID %in% unique(no_access$ID),
                str_detect(qname, "D-3")) %>%
         group_by(q_text, order) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp_no_data*100, 1)) %>% 
         group_by(q_text) %>% 
         mutate(tot_perc = sum(percentage), ave_score = mean(order)) %>% 
  ggplot(aes(y = reorder(q_text, ave_score, decreasing = TRUE), x = percentage, fill = fct_rev(factor(order))))+
  geom_col() +
  labs(y = "", x = paste0("Percentage of respondents (N = ", num_resp_no_data, ")"), title = "What datasets are you interested in?") +
  scale_fill_viridis_d(option = "plasma", name = "Rank", direction = -1)+
  scale_y_discrete(labels = function(x) str_wrap(x, width = 50))+
  geom_text(aes(x = 79, y = q_text, label = round(ave_score, 2)), check_overlap = TRUE)+
  theme_bw()+
  guides(fill = guide_legend(title = "Rank",
                             reverse = TRUE))
```

The survey asked these respondents broad questions on how often they would access these data, and what they would use them for.

This figure shows that 25% (2 respondents) were not interested in accessing data, and that about half of the respondents would either access data either once a month or once a year (25% each).

```{r no_access_howoften, fig.width = 8, fig.height = 3, echo = FALSE, message = FALSE, fig.align = 'center'}

ggplot(no_access %>% 
         filter(str_detect(qname, "ND-1")) %>% 
         mutate(q_text = factor(q_text, levels = c("Daily", "At least once a week",
                                                   "2-3 times a month", "Once a month",
                                                   "Once every 6 months", "Once every year",
                                                   "Less than once a year",
                                                   "Never (not interested in accessing data)"))) %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/sum(cnt)*100, 1)),
       aes(y = fct_rev(q_text), x = percentage))+
  geom_col(fill = "cyan4") +
  labs(y = "", x = paste0("Percentage of respondents (N = ", num_resp_no_data, ")"), 
       title = "If you had the opportunity to access data in the future, how often would you\naccess or obtain these data?") +
  theme_bw()+
  theme(plot.title.position = "plot")
```

--------------------------------------------------------

In terms of what people would use data for, the majority would use it for (non-research / non-educational) work-related purposes and decision making, as per the figure below. Also here, respondents could pick more than one answer, so the sum of all percentages is more than 100%.

```{r no_access_what, fig.width = 8, fig.height = 3, echo = FALSE, message = FALSE, fig.align = 'center'}
# count total number of answers
num_answers <- no_access %>%
  filter(str_detect(qname, "ND-2")) %>%
  summarize(num_answers = n()) %>% 
  pull(num_answers)

ggplot(no_access %>% 
         filter(str_detect(qname, "ND-2")) %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp_no_data*100, 1)),
       aes(y = reorder(q_text, percentage), x = percentage))+
  geom_col(fill = "paleturquoise3") +
  labs(y = "", x = paste0("Percentage of respondents (N = ", num_resp_no_data, ")"), 
       title = "If you had the opportunity to access data in the future, what would you use these data for?") +
  scale_y_discrete(labels = function(x) str_wrap(x, width = 30))+
  theme_bw()+
  theme(plot.title.position = "plot")
```

Under "Other", respondents listed:

* environmental impacts, and
* resilience planning

:::: {.infobox .info data-latex="{info}"}
**Take home message**

- For the (8) respondents that had not accessed data before, their main interest would be in data on water level information, reserve or trail closures, and water quality information.
- If they could access data, 25% of respondents would access data once a month and 25% once a year.
- 25% of respondents (2 people) are not interested in accessing data.
- The majority of people would use it for (non-research / non-educational) work-related purposes and decision making - 3 people picked each of those options.

::::

____________________________________________________

### 4. Feedback from respondents that have accessed data before

For respondents that have/had accessed data before, the survey asked which datasets they had accessed, and a number of detailed questions about their experiences related to how they accessed these data, the advantages and disadvantages of this access, the frequency of access, the usage of the data, and respondents' satisfaction with these data (for their needs).

```{r access_what, fig.width = 8, fig.height = 4, echo = FALSE, message = FALSE, fig.align = 'center'}
ggplot(yes_data %>% 
         filter(qname_main == "YD-1") %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/sum(cnt)*100, 1)),
       aes(y = reorder(q_text, percentage), x = percentage, fill = percentage))+
  geom_col() +
  labs(x = "Percentage of responses", y = "", 
       title = "What Guana Estuary data do you currently use, or have you used in the past?") +
  scale_y_discrete(labels = function(x) str_wrap(x, width = 40))+
  scale_fill_distiller(palette = "GnBu", direction = 1)+
  theme_bw()+
  theme(legend.position = "none",
        plot.title.position = "plot")

# Needed for the next question
# Save the order 
yes_data_order <- yes_data %>%
  filter(qname_main == "YD-1") %>%
  group_by(q_text) %>%
  summarize(cnt = n()) %>%
  mutate(percentage = round(cnt/sum(cnt)*100, 1)) %>% 
  select(q_text, percentage) %>% 
  mutate(q_text = fct_reorder(q_text, percentage, .desc = TRUE)) 

q_text_order <- levels(yes_data_order$q_text)

library(RColorBrewer)
# Get the colors
color_vector <- brewer.pal(n = 7, name = "GnBu")
```

The following table summarizes the detailed questions per dataset. The numbers represent percentages of respondents, or, in the case of multiple possible answers, percentages of all responses (indicated with an asterisk, *).
*This table still needs some reorganizing and reordering.*

There was an option "Other", to which there was one response: LiDAR data. *This information will be added to this table*.

```{r access_detail_table, echo = FALSE, warning = FALSE, message = FALSE}

# order datasets as per the previous ranking
# order answers either by order (e.g. frequency) or percentages of votes?

yes_data_table <- yes_data %>% 
  filter(qname_main != "YD-1") %>% 
  group_by(field_name, main, q_text) %>% 
  summarize(cnt = n()) %>%
  mutate(percentage = round(cnt/sum(cnt)*100)) %>% 
  select(-cnt) %>% 
  ungroup() %>% 
  group_by(field_name, main) %>% 
  pivot_wider(names_from = field_name, values_from = percentage, values_fill = 0) %>%
  select(q_text_order) %>% 
  left_join(select(yes_data, main, qname_main)) %>% 
  distinct() %>% 
  arrange(qname_main) %>% 
  ungroup() %>% 
  select(-qname_main, -`Other (please specify)`)

for(i in names(yes_data_table)[2:8]){
  yes_data_table$i <- color_tile("white", color_vector[i])(yes_data_table$i)
  yes_data_table[,c(cols[i])] <- color_tile("white", color_vector[i])(yes_data_table[,c(cols[i])])

}
# Error in gradient(as.numeric(x), ...) : 
#  'list' object cannot be coerced to type 'double'
cols = names(yes_data_table)[2:8]
yes_data_table[,c(cols[1],i)]

yes_data_table[,1] <- color_tile("white", color_vector[1])(yes_data_table[,1])
yes_data_table$`Information on fish, shellfish or other aquatic organisms` <- color_tile("white", "#F0F9E8")(yes_data_table$`Information on fish, shellfish or other aquatic organisms`)
# yes_data_table$`Information on terrestrial animals` <- color_tile("white", "chartreuse4")(yes_data_table$`Information on terrestrial animals`)
# yes_data_table$`Information on vegetation (salt marsh or uplands)` <- color_tile("white", "chartreuse4")(yes_data_table$`Information on vegetation (salt marsh or uplands)`)
# yes_data_table$`Reserve or trail closures` <- color_tile("white", "chartreuse4")(yes_data_table$`Reserve or trail closures`)
# yes_data_table$`Water level information (tides, Guana lake, river)` <- color_tile("white", "chartreuse4")(yes_data_table$`Water level information (tides, Guana lake, river)`)
# yes_data_table$`Water quality information (including nutrients and algae)` <- color_tile("white", "chartreuse4")(yes_data_table$`Water quality information (including nutrients and algae)`)
# yes_data_table$`Weather information` <- color_tile("white", "chartreuse4")(yes_data_table$`Weather information`)

yes_data_table %>% 
  select(-main) %>% 
  kbl(escape = FALSE) %>% 
  kable_minimal("striped") %>%
  #collapse_rows(columns = 1, valign = "top")
  pack_rows("How do you most frequently obtain or access these data?", 1, 4) %>%
  pack_rows("What are the advantages of this primary method of accessing or obtaining these data?*", 5, 10) %>% 
  pack_rows("What are the disadvantages of the primary method of accessing or obtaining these data?*", 11, 16) %>%
  pack_rows("How often do/did you access or obtain these data?", 17, 23) %>% 
  pack_rows("What do you typically use these data for?*", 24, 29) %>% 
  pack_rows("How well do these data generally satisfy your need(s)?", 30, 33)
```

--------------------------------------------------------

**The websites that respondents used to obtain data were:**

* GTM website (gtmnerr.org)
    + https://gtmnerr.org/visit/
* SEACAR
* Johnson County weather stations
* SWMP
* National Weather Service Tide Data
* CDMO (https://cdmo.baruch.sc.edu//)
* https://www.weather.gov/jax/fire
* https://www.windfinder.com/tide/south_ponte_vedra_beach
* UF IFAS
* Florida DEP
* NOAA Digital Coast
* weather.gov
* https://www.surf-forecast.com/breaks/South-Ponte-Vedra-Beach/tides/latest
* iNaturalist (inaturalist.org)

**"Other" avenues for accessing data were:**

* From GTM files (employees)
* Weather Channel App
* FieldMaps, Survey123 apps using GTM Staff Access
* View on website (no download)
* Attending GTM info sessions or obtaining info from newsletter
* Newsletter info
* Directly ask staff
* Attending state of the reserve presentations.
* FWC data
* State sites
* Spot monitoring of salinity each week
* Google
* Call the Visitor center
* Email
* NOAA

**Disadvantages listed by respondents under "Other" were:**

  * Various formats
  * Login required
  * Not current; hard to find on website (although once found, easy to access)
  * Somewhat haphazard, almost anecdotal
  * The info might not always be up to date
  * Only available when presented by the staff.
  * Not easy to view on mobile devices.
  * Being a pain to the researchers
  * SPOT weather forecast not available to general public
  * Not as accurate as other salinity measuring techniques
  * Not directly representative of the Guana System
  * Website to download/access is cumbersome otherwise I'd do it myself. Want to make sure I am getting the latest data and I trust staff
  * Not familiar with how to access it on my own
  * Would be easier if online
  * Sometimes inaccurate
  * Lots of data, lots out of date, doesn't address current situation
  * Need to call during hours of operation
  * May have a plan on visit but then can't do what you planned
  * Have to go to multiple places to get data
  * Multiple sources required to find info
  * Some information available in all trails from a user perspective not from the actual reserve
  * Not all (Guana) data is available in SWMP CDMO
  * Would be nice to have a public database
*These are linked to specific datasets, this will be clarified in the final version of the report*

**In terms of usage of data, respondents added the following under "Other":**

* Monitoring of invasive plant species sites for re-ocurrence / growth
* Leisure
* Personal interest
* Helpful/useful during some of the volunteer programs
* Recreation
* Prescribed fire weather forecasts
* Vegetation management on lake
* Guana Dam management
* I would access it more if I knew how to get to the data

_______________________________________________________________

### 5. Dashboard preferences

The survey asked respondents about their preferences regarding dashboard features (type and format of information, data delivery mode) and how they would access the dashboard.

By "dashboard" we meant a user interface on a computer display that presents (up-to-date) information with visualization tools such as graphs, charts, and tables - in a dynamic and interactive way.

```{r dash_how, fig.width = 5, fig.height = 2, echo = FALSE, message = FALSE, fig.align = 'center'}
ggplot(dashboard %>% 
         filter(qname_main == "T-1") %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/sum(cnt)*100, 1)),
       aes(y = reorder(q_text, percentage), x = percentage, fill = q_text))+
  geom_col() +
  labs(y = "", x = "Percentage of responses", title = "How would you prefer to access data?") +
  scale_fill_viridis_d()+
  theme_bw()+
  theme(legend.position = "none",
        plot.title.position = "plot")
```

--------------------------------------------------------

```{r dash_type, fig.width = 7, fig.height = 4, echo = FALSE, message = FALSE, fig.align = 'center'}
ggplot(dashboard %>% 
         filter(qname_main == "T-2") %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/sum(cnt)*100, 1)),
       aes(y = reorder(q_text, percentage), x = percentage, fill = q_text))+
  geom_col() +
  labs(y = "", x = "Percentage of responses", title = "What type of information do you prefer?") +
  scale_fill_viridis_d(option = "plasma")+
  scale_y_discrete(labels = function(x) str_wrap(x, width = 20))+
  theme_bw()+
  theme(legend.position = "none",
        plot.title.position = "plot")
```

--------------------------------------------------------

```{r dash_form, fig.width = 7, fig.height = 4, echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center'}
ggplot(dashboard %>% 
         filter(qname_main == "T-3") %>% 
         group_by(q_text, order) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp*100, 1)),
       aes(y = reorder(q_text, percentage), x = percentage, fill = fct_rev(factor(order))))+
  geom_col() +
  labs(y = "", x = "Percentage of responses", title = "What form of information do you prefer?") +
  scale_fill_viridis_d(option = "rocket", name = "Rank", direction = -1)+
  scale_y_discrete(labels = function(x) str_wrap(x, width = 30))+
  theme_bw()+
  theme(plot.title.position = "plot",
        legend.position = "top",
        legend.spacing.x = unit(0.5, 'cm'))+
  guides(fill = guide_legend(title = "Rank",
                             nrow = 1,
                             label.position = "bottom",
                             title.position = "left", title.vjust = 1,
                             reverse = TRUE))

# ggplot(dashboard %>% 
#          filter(qname_main == "T-3") %>% 
#          group_by(q_text) %>% summarize(ave_rank = mean(order, na.rm = TRUE)) %>% 
#          mutate(q_text = fct_reorder(q_text, ave_rank)),
#        aes(x = ave_rank, y = fct_rev(q_text))) +
#   geom_col(fill = "royalblue")+
#   labs(y = "", x = "", title = "What format of data delivery would suit your needs best?\nAverage ranking (1 = most interested in)")+
#   theme_bw()+
#   theme(axis.text.y = element_text(size=15))
```

--------------------------------------------------------

```{r dash_delivery, fig.width = 7, fig.height = 5, echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center'}
ggplot(dashboard %>% 
         filter(qname_main == "T-4") %>% 
         group_by(q_text, order) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp*100, 1)),
       aes(y = reorder(q_text, percentage), x = percentage, fill = fct_rev(factor(order))))+
  geom_col() +
  labs(y = "", x = "Percentage of responses", title = "What format of data delivery would suit your needs best?") +
  scale_fill_viridis_d(option = "rocket", name = "Rank", direction = -1)+
  scale_y_discrete(labels = function(x) str_wrap(x, width = 30))+
  theme_bw()+
  theme(plot.title.position = "plot",
        legend.position = "top",
        legend.spacing.x = unit(0.5, 'cm'))+
  guides(fill = guide_legend(title = "Rank",
                             nrow = 1,
                             label.position = "bottom",
                             title.position = "left", title.vjust = 1,
                             reverse = TRUE))

# ggplot(dashboard %>% 
#          filter(qname_main == "T-4") %>% 
#          group_by(q_text) %>% summarize(ave_rank = mean(order, na.rm = TRUE)) %>% 
#          mutate(q_text = fct_reorder(q_text, ave_rank)),
#        aes(x = ave_rank, y = fct_rev(q_text))) +
#   geom_col(fill = "royalblue")+
#   labs(y = "", x = "", title = "What format of data delivery would suit your needs best?\nAverage ranking (1 = most interested in)")+
#   theme_bw()+
#   theme()
```

___________________________________________________________

### 6. Characteristics of respondents

Finally, the survey requested demographic information from respondents. This helps the project team get a better understanding of the dashboard's target audience.

#### 6.1 Age and gender
```{r age, fig.width = 12, fig.height = 4, echo = FALSE, message = FALSE, fig.align = 'center'}
age <- ggplot(demogr %>% 
         filter(qname == "DE-2") %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/sum(cnt)*100, 1)),
       aes(y = fct_rev(factor(q_text)), x = percentage))+
  geom_col(fill = "seagreen3") +
  labs(x = "Percentage of respondents", y = "", title = "What is your age group?") +
  theme_bw()

gender <- ggplot(demogr %>% 
  filter(qname == "DE-3") %>% 
  group_by(q_text) %>% 
  summarize(cnt = n()) %>%
  mutate(percentage = round(cnt/sum(cnt)*100, 1)),
       aes(x = factor(q_text), y = percentage, fill = factor(q_text)))+
  geom_col() +
  labs(x = "", y = "Percentage of respondents", title = "What is your gender?") +
  scale_fill_manual(values = c("purple", "darkgreen"))+
  theme_bw()+
  theme(legend.position = "none")

plot_grid(age, gender, ncol = 2, align = "v")
```

----------------------------------------------------

#### 6.2 Distance from the Guana Estuary
``` {r distance, fig.width = 5, fig.height = 4, echo = FALSE, message = FALSE, fig.align = 'center'}
ggplot(demogr %>% 
         filter(qname == "DE-4") %>% 
         group_by(q_text) %>% 
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/sum(cnt)*100, 1)),
       aes(y = q_text, x = percentage))+
  geom_col(fill = "royalblue") +
  labs(x = "Percentage of respondents", y = "Driving distance (minutes)", title = "How far are you from the Guana Estuary?") +
  theme_bw()+
  theme(plot.title.position = "plot")
```

____________________________________________________

## Next steps
The project team will still refine details in this report, and distribute/publish the final version by the end of August 2023. The final report will also include dashboard design recommendations and considerations based on the survey results (and previous workshops).

To access the code that created this document, the survey result data, or jpg versions of the figures, go to https://github.com/GTMNERR-Science-Transfer/Survey-results. 

The project team has also started drafting a basic dashboard; we will be in touch soon about further steps on this, and to inform you of upcoming participation and discussion opportunities.

Suggestions and comments on this draft report are very welcome; please email Dr. Geraldine Klarenberg at gklarenberg@ufl.edu, or leave an "Issue" on the above linked GitHub repository.

_____________________________________________________

### Appendix: Visualizations accompanying section 6

The figures below provide visual interpretations of the table in section 6, on the datasets that respondents have accessed.

```{r all_q_per_dataset, fig.width = 7, fig.height = 15, echo = FALSE, fig.align = 'center'}
# There are 8 dataset options to choose, for data accessed. Loop over all of them.

for (i in 1:8){
  
  data_name <- yes_data %>% 
    filter(field_no == i) %>% 
    pull(field_name) 
  data_name <- data_name[1]
  
  obtain <- ggplot(yes_data %>% 
                     filter(field_no == i, qname_main == "YD-2") %>%
                     group_by(q_text) %>% 
                     summarize(cnt = n()) %>%
                     mutate(percentage = round(cnt/sum(cnt)*100, 1)),
         aes(y = reorder(q_text, percentage), x = percentage, fill = q_text))+
    geom_col() +
    labs(x = "", y = "", 
         title = data_name,
         subtitle = "How do you most frequently obtain or access these data?") +
    scale_fill_viridis_d(option = "viridis")+
    theme_bw()+
    theme(legend.position = "none",
          plot.title.position = "plot",
          plot.title = element_text(face="bold"))
  
  adv <- ggplot(yes_data %>% 
                  filter(field_no == i, qname_main == "YD-3") %>% 
                  group_by(q_text) %>% 
                  summarize(cnt = n()) %>%
                  mutate(percentage = round(cnt/sum(cnt)*100, 1)),
                aes(y = reorder(q_text, percentage), x = percentage, fill = q_text))+
    geom_col() +
    labs(x = "", y = "", subtitle = "What are the advantages of this primary method of accessing or obtaining these data?") +
    scale_fill_viridis_d(option = "mako")+
    theme_bw()+
    theme(legend.position = "none",
          plot.title.position = "plot")
  
  disadv <- ggplot(yes_data %>% 
                     filter(field_no == i, qname_main == "YD-4") %>% 
                     group_by(q_text) %>% 
                     summarize(cnt = n()) %>%
                     mutate(percentage = round(cnt/sum(cnt)*100, 1)),
                   aes(y = reorder(q_text, percentage), x = percentage, fill = q_text))+
    geom_col() +
    labs(x = "", y = "", subtitle = "What are the disadvantages of this primary method of accessing or obtaining these data?") +
    scale_fill_viridis_d(option = "rocket")+
    theme_bw()+
    theme(legend.position = "none",
          plot.title.position = "plot")
  
  howoften <- ggplot(yes_data %>% 
                       filter(field_no == i, qname_main == "YD-5") %>% 
                       group_by(q_text) %>% 
                       summarize(cnt = n()) %>%
                       mutate(percentage = round(cnt/sum(cnt)*100, 1)),
                     aes(y = factor(q_text, levels = c("Daily", "At least once a week",
                                                       "2-3 times a month", "Once a month",
                                                       "Once every 6 months", "Once every year",
                                                       "Less than once a year")), # Create levels so they stay in the correct order
                         x = percentage))+
    geom_col(fill = "green3") +
    labs(x = "", y = "", subtitle = "How often do/did you access or obtain these data?") +
    theme_bw()+
    theme(legend.position = "none",
          plot.title.position = "plot")
  
  use <- ggplot(yes_data %>% 
                  filter(field_no == i, qname_main == "YD-6") %>% 
                  group_by(q_text) %>% 
                  summarize(cnt = n()) %>%
                  mutate(percentage = round(cnt/sum(cnt)*100, 1)),
                aes(y = reorder(q_text, percentage),
                x = percentage,
                fill = q_text))+
    geom_col() +
    labs(x = "", y = "", subtitle = "What do you typically use these data for?") +
    scale_fill_viridis_d(option = "plasma")+
    theme_bw()+
    theme(legend.position = "none",
          plot.title.position = "plot")
  
  satisf <- ggplot(yes_data %>% 
                     filter(field_no == i, qname_main == "YD-7") %>% 
                     group_by(q_text) %>% 
                     summarize(cnt = n()) %>%
                     mutate(percentage = round(cnt/sum(cnt)*100, 1)),
                   aes(y = factor(q_text,levels = c("Extremely well", "Very well",
                                                    "Moderately well", "Slightly well",
                                                    "Not well at all")),
                       x = percentage))+
    geom_col(fill = "skyblue2") +
    labs(x = "", y = "", subtitle = "How well do these data generally satisfy your need(s)?") +
    theme_bw()+
    theme(legend.position = "none",
          plot.title.position = "plot")
  
  all <- plot_grid(obtain, adv, disadv, howoften, use, satisf, ncol = 1, align = "v")
  print(all)
}
```
