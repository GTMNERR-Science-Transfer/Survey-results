---
title: "Guana Estuary Data Dashboard Needs Assessment: Survey Results"
author: "Geraldine Klarenberg"
date: "2023-09-08"
output: 
  html_document:
    css: box_style.css
#output: pdf_document
---

#### Final draft

##### Project: Using collaborative open science tools to improve engagement with the ecology of the Guana River Estuary
###### *Project team: Geraldine Klarenberg, Kristie Perez, Nikki Dix, Nia Morales, and Shirley Baker*

The University of Florida and Guana Tolomato Matanzas National Estuarine Research Reserve (GTMNERR) are partnering with the local community and broader science community to develop a web-based, public-facing, interactive dashboard to provide access to Guana Estuary datasets. The aim of this work is to support open science and to increase diverse engagement with the Guana Estuary within the GTMNERR by making the data available interactively, using visualization tools.

To this end, the project team sought feedback from those who have been involved with the Guana Estuary to help them to better understand their needs. This document summarizes the results of an online survey that was made available via email, social media, and QR code. It was sent to the Technical Advisory Group and project-specific stakeholders (identified by the GTMNERR research coordinator).

This survey was approved by the University of Florida's Institutional Review Board (IRB), IRB#202202509.

```{r load_package_data, echo = FALSE, message = FALSE}
library(tidyverse)
library(kableExtra)
library(cowplot)
library(formattable)
library(RColorBrewer)

intro <- read_csv("../data_deidentified/subsets/intro_results_basic.csv")
no_access <- read_csv("../data_deidentified/subsets/data_no_results_basic.csv")
yes_data <- read_csv("../data_deidentified/subsets/data_yes_results_basic.csv")
dashboard <- read_csv("../data_deidentified/subsets/dashboard_results_basic.csv")
demogr <- read_csv("../data_deidentified/subsets/demographics_results_basic.csv")
```

### 1. Response rate
We received responses from 51 individuals. Out of these, 14 surveys were unfinished. For this report, we also took the unfinished surveys into account. Most results are shown as percentages of respondents picking certain options or answers. Since the total number of responses varies, due to those unfinished surveys, all results show the total number of people (*N*) that answered a question with *N =*.

47 respondents filled in the survey based on a link received via email, 3 via social media, 0 via the QR code available at the GTMNERR Welcome Center, and 1 via the QR code available at the kiosk at the dam.

_____________________________________________________________

### 2. Introductory questions

The survey started with asking respondents about their connection to the Guana Estuary, how often they engage with the Guana Estuary, what data they would be interested in, and whether or not they ever accessed data associated with the Guana Estuary.

For the purposes of this project, and this survey, "Guana Estuary" refers to the Guana Lake and Guana River: the area north and south of the Guana Dam, from Micklers Road to the Tolomato River / intracoastal.

```{r num_respondents, echo = FALSE}
# Create variable with total number of respondents, to be used as annotation on plots
num_resp <- length(unique(intro$ID))
```

#### 2.1 Guana Estuary connection

We asked respondents about their connection with the Guana Estuary. The figure below summarizes the responses, but note that people could pick more than 1 option. This is why the sum of all percentages adds up to more than 100%. 

In total there were 111 connections chosen. E.g. a little over 60% of respondents do recreational activities at the Guana Estuary, and almost 50% collect data or use data for scientific purposes - and these choices are not mutually exclusive! Someone could collect data and *also* enjoy the Guana Estuary recreationally. Or volunteer and *also* use the Guana Estuary for educational purposes.

```{r connected, fig.width = 7, fig.height = 3, echo = FALSE, message = FALSE, fig.align = 'center'}
# count total number of answers
num_answers <- intro %>%
  filter(str_detect(qname, "D-1")) %>% 
  summarize(num_answers = n()) %>% 
  pull(num_answers)

ggplot(intro %>% 
         filter(str_detect(qname, "D-1")) %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp*100, 1)), #sum(cnt)
       aes(y = reorder(q_text, percentage), x = percentage, fill = percentage))+
  geom_col(color = "darkgrey") +
  labs(y = "", x = paste0("Percentage of all respondents (N = ", num_resp, ")"), 
       title = "How are you connected to the Guana Estuary?",
       caption  = "NOTE: Respondents could pick more than 1 response") +
  scale_fill_distiller(palette = "PuBuGn", direction = 1)+
  #scale_fill_viridis_d(option = "mako")+
  scale_y_discrete(labels = function(x) str_wrap(x, width = 50))+
  theme_bw()+
  theme(legend.position = "none",
        plot.title.position = "plot",
        plot.caption.position =  "plot")
```

Under "Other", respondents answered:

* Lake management - FWC
* Health
* GTM-NERR MAG member
* Sometimes bring international visitors for professional conversations (am retired now).

--------------------------------------------------------

#### 2.2 Level of engagement
```{r engage, fig.width = 6, fig.height = 3, echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center'}
ggplot(intro %>% 
         filter(qname == "D-2") %>% 
         mutate(q_text = fct_rev(factor(q_text, levels = c("Daily", "At least once a week",
                                                 "2-3 times a month", "Once a month",
                                                 "Once every 6 months", "Once every year",
                                                 "Less than once a year")))) %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp*100, 1)), 
       aes(y = q_text,
           x = percentage,
           fill = cnt))+
  geom_col(color = "darkgrey") +
  labs(x = paste0("Percentage of respondents (N = ", num_resp, ")"), 
       y = "", title = "How often do you engage with the Guana Estuary?") +
  scale_fill_distiller(palette = "PuBuGn", direction = 1)+ #"BuGn"
  theme_bw()+
  theme(legend.position = "none",
        plot.title.position = "plot")
```

--------------------------------------------------------

#### 2.3 Data of interest (in general)
We asked respondents what Guana Estuary data they would be interested in, regardless of whether or not they currently have access to these data. Respondents were also asked to rank these datasets, with 1 being the data they are most interested in. They could pick as many or few as they wanted.

The figure below shows the percentage of respondents that picked a particular dataset being of interest to them. E.g. over 80% of respondents picked water quality data. The colors indicate how they ranked it: for instance, almost 40% of all respondents ranked water quality data as their number 1 dataset of interest.

```{r what_data, fig.width = 7, fig.height = 6, echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center'}
ggplot(intro %>% 
         filter(str_detect(qname, "D-3")) %>% 
         group_by(q_text, order) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp*100, 1)) %>% 
         group_by(q_text) %>% 
         mutate(tot_perc = sum(percentage)),
       aes(y = reorder(q_text, tot_perc), x = percentage, fill = fct_rev(factor(order))))+
  geom_col(color = "darkgrey") +
  labs(y = "", x = paste0("Percentage of respondents (N = ", num_resp, ")"), 
       title = "What datasets are you interested in?",
       caption  = "NOTE: Respondents could pick more than 1 response") +
  scale_fill_viridis_d(option = "plasma", name = "Rank", direction = -1)+
  scale_y_discrete(labels = function(x) str_wrap(x, width = 50))+
  theme_bw()+
  theme(plot.title.position = "plot",
        legend.position = "top",
        legend.spacing.x = unit(0.5, 'cm'))+
  guides(fill = guide_legend(title = "Rank",
                             nrow = 1,
                             label.position = "bottom",
                             title.position = "left", title.vjust = 1,
                             reverse = TRUE))
```

Under "Other", the 4 types of datasets mentioned were: **historical maps**, **water fowl**, **dam operations**, **natural resource management practices/techniques/results**.


--------------------------------------------------------

#### 2.4 Previous experience with accessing data associated with Guana Estuary

The survey asked respondents whether they had accessed data before, and by "data", we meant "information, especially facts or numbers, collected to be examined and considered and used to help decision-making; or information in an electronic form that can be stored and used by a computer" for instance spreadsheets, databases, graphs, and maps." 

```{r accessed_data, fig.width = 4, fig.height = 3, echo = FALSE, message = FALSE, fig.align = 'center'}
ggplot(intro %>% 
         filter(qname == "D-4") %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/sum(cnt)*100, 1)),
       aes(x = q_text, y = percentage, fill = q_text))+
  geom_col(color = "darkgrey") +
  labs(x = "", y = paste0("Percentage of respondents (N = ", num_resp, ")"),
       title = "Have you accessed data before?") +
  scale_fill_manual(values = c("#67a9cf", "#02818a"))+
  theme_bw()+
  theme(legend.position = "none")
```


:::: {.infobox .info data-latex="{info}"}
**Take home messages**

- The majority of respondents use the Guana Estuary recreationally (62.7%) and almost half (49%) collect or use data for scientific purposes. In third and fourth place are other work-related and educational connections (resp. 33.3% and 29.4%).
- Engagement with the Guana Estuary is mostly once a month (21.6% of respondents), with a tie (19.6%) for once a week and once every 6 months. Daily engagement was indicated by 17.6% of respondents. 
- The top 4 datasets of interest, chosen by more than 60% of the respondents, are: water quality information, information on shellfish, fish and other aquatic organisms, water level information, and information on vegetation. 
- The majority of respondents (83.7%) has accessed data before.

::::

Based on their response whether or not they had accessed data, respondents answered different sets of questions. The results are summarized in the next two sections.

___________________________________________________________

### 3. Feedback from respondents that had not accessed data before

For respondents that had not (yet) accessed data (N = 8), the figure below summarizes their answers from section 2.3 (datasets of interest). In this figure, the datasets are ordered according to their average ranking, once again 1 being the dataset of most interest.

This paints an interesting picture, as, for instance, water quality data were picked by most respondents, but in terms of average ranking it comes in 4th (3rd) place. Only one person responded they were not interested in any data ("None"), hence this item ranks first, as the average of 1 is 1... We can essentially disregard this item. The 3 datasets that have rankings between 2 and 3 are water level information, reserve or trail closures, and water quality information. However, information on vegetation, and information on fish, shellfish and other aquatic organisms was also picked by more than 60% (5 respondents) - but it was ranked lower on average.  

```{r link_to_23_no_data, echo = FALSE, message = FALSE}
# count total number of answers
num_resp_no_data <- length(unique(no_access$ID))

intro %>%
         filter(ID %in% unique(no_access$ID),
                str_detect(qname, "D-3")) %>%
         group_by(q_text, order) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp_no_data*100, 1)) %>% 
         group_by(q_text) %>% 
         mutate(tot_perc = sum(percentage), ave_score = sum(order*cnt)/sum(cnt)) %>% 
  ggplot(aes(y = reorder(q_text, ave_score, decreasing = TRUE), x = percentage, fill = fct_rev(factor(order))))+
  geom_col(color = "darkgrey") +
  labs(y = "", x = paste0("Percentage of respondents (N = ", num_resp_no_data, ")"), 
       title = "What datasets are you interested in?",
       caption  = "NOTE: Respondents could pick more than 1 response") +
  scale_fill_brewer(palette = "YlGn", direction = 1)+
  #scale_fill_viridis_d(option = "plasma", name = "Rank", direction = -1)+
  scale_y_discrete(labels = function(x) str_wrap(x, width = 50))+
  geom_text(aes(x = 79, y = q_text, label = round(ave_score, 2)), check_overlap = TRUE)+
  theme_bw()+
  guides(fill = guide_legend(title = "Rank",
                             reverse = TRUE))
```

The survey asked these respondents broad questions on how often they would access these data, and what they would use them for.

The figure below shows that 25% (2 respondents) were not interested in accessing data, and that about half of the respondents would access data either once a month or once a year (25% each).

```{r no_access_howoften, fig.width = 8, fig.height = 3, echo = FALSE, message = FALSE, fig.align = 'center'}

ggplot(no_access %>% 
         filter(str_detect(qname, "ND-1")) %>% 
         mutate(q_text = factor(q_text, levels = c("Daily", "At least once a week",
                                                   "2-3 times a month", "Once a month",
                                                   "Once every 6 months", "Once every year",
                                                   "Less than once a year",
                                                   "Never (not interested in accessing data)"))) %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/sum(cnt)*100, 1)),
       aes(y = fct_rev(q_text), x = percentage, fill = percentage))+
  geom_col(color = "darkgrey") +
  labs(y = "", x = paste0("Percentage of respondents (N = ", num_resp_no_data, ")"), 
       title = "If you had the opportunity to access data in the future, how often would you\naccess or obtain these data?") +
  scale_fill_distiller(palette = "YlGn", direction = 1)+
  theme_bw()+
  theme(plot.title.position = "plot", legend.position = "none")
```

--------------------------------------------------------

In terms of what people would use data for, the majority would use it for (non-research / non-educational) work-related purposes and decision making, as per the figure below. Also here, respondents could pick more than one answer, so the sum of all percentages is more than 100%.

```{r no_access_what, fig.width = 8, fig.height = 3, echo = FALSE, message = FALSE, fig.align = 'center'}
# count total number of answers
num_answers <- no_access %>%
  filter(str_detect(qname, "ND-2")) %>%
  summarize(num_answers = n()) %>% 
  pull(num_answers)

ggplot(no_access %>% 
         filter(str_detect(qname, "ND-2")) %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp_no_data*100, 1)),
       aes(y = reorder(q_text, percentage), x = percentage, fill = percentage))+
  geom_col(color = "darkgrey") +
  labs(y = "", x = paste0("Percentage of respondents (N = ", num_resp_no_data, ")"), 
       title = "If you had the opportunity to access data in the future, what would you use these data for?",
       caption  = "NOTE: Respondents could pick more than 1 response") +
  scale_fill_distiller(palette = "YlGn", direction = 1)+
  scale_y_discrete(labels = function(x) str_wrap(x, width = 30))+
  theme_bw()+
  theme(plot.title.position = "plot", legend.position = "none")
```

Under "Other", respondents listed **environmental impacts** and **resilience planning**.

:::: {.infobox .info data-latex="{info}"}
**Take home messages**

- For the (8) respondents that had not accessed data before, their main interest would be data on water level information, reserve or trail closures, and water quality information.
- If they could access data, 25% of respondents would access data once a month and 25% once a year.
- 25% of respondents (2 people) are not interested in accessing data.
- The majority of usage of data would be for (non-research / non-educational) work-related purposes and decision making: each of those options was picked by 3 people.

::::

____________________________________________________

### 4. Feedback from respondents that have accessed data before

For respondents that have accessed data before (N = 40), the figure below summarizes their answers from section 2.3 (datasets of interest - regardless of whether respondents can or have accessed these data). In this figure, the datasets are ordered according to their average ranking, once again 1 being the dataset of most interest.

The top 3 data of interest are water quality information, information on shellfish, fish and other aquatic organisms, and water level information: both in terms of average ranking and the percentage of respondents picking these. Interestingly, more than half the respondents chose weather information and vegetation information as data of interest, but their rankings are relatively low. 

```{r link_to_23_yes_data, echo = FALSE, message = FALSE}
# count total number of answers
num_resp_yes_data <- length(unique(yes_data$ID))

intro %>%
         filter(ID %in% unique(yes_data$ID),
                str_detect(qname, "D-3")) %>%
         group_by(q_text, order) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp_yes_data*100, 1)) %>% 
         group_by(q_text) %>% 
         mutate(tot_perc = sum(percentage), ave_score = sum(order*cnt)/sum(cnt)) %>% 
  ggplot(aes(y = reorder(reorder(q_text, tot_perc), ave_score, decreasing = TRUE), 
             x = percentage, fill = fct_rev(factor(order))))+
  geom_col(color = "darkgrey") +
  labs(y = "", x = paste0("Percentage of respondents (N = ", num_resp_yes_data, ")"), 
       title = "What datasets are you interested in?",
       caption  = "NOTE: Respondents could pick more than 1 response") +
  scale_fill_viridis_d(option = "plasma", name = "Rank", direction = -1)+
  scale_y_discrete(labels = function(x) str_wrap(x, width = 50))+
  geom_text(aes(x = 98, y = q_text, label = round(ave_score, 2)), check_overlap = TRUE)+
  theme_bw()+
  guides(fill = guide_legend(title = "Rank",
                             reverse = TRUE))
```

Under "Other", the 4 types of datasets mentioned were: **historical maps**, **water fowl**, **dam operations**, **natural resource management practices/techniques/results**.

---------------------------------------------------------------------------------

In the section for respondents that have/had accessed data before, the survey asked which datasets they had accessed, and a number of detailed questions about their experiences related to how they accessed these data, the advantages and disadvantages of this access, the frequency of access, the usage of the data, and respondents' satisfaction with these data (for their needs).

```{r access_what, fig.width = 8, fig.height = 4, echo = FALSE, message = FALSE, fig.align = 'center'}

# Get the colors (order blue -> yellow, wq -> other). Create 9 colors and remove
# the first one (darkest blue) because it's difficult to read in the table later
color_vector <- rev(brewer.pal(n = 9, name = "YlGnBu"))
color_vector <- color_vector[-1]

ggplot(yes_data %>% 
         filter(qname_main == "YD-1") %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp_yes_data*100, 1)),
       aes(y = reorder(q_text, percentage), x = percentage, fill = percentage))+
  geom_col(color = "darkgrey") +
  labs(x = paste0("Percentage of respondents (N = ", num_resp_yes_data, ")"), 
       y = "", 
       title = "What Guana Estuary data do you currently use, or have you used in the past?",
       caption  = "NOTE: Respondents could pick more than 1 response") +
  scale_y_discrete(labels = function(x) str_wrap(x, width = 40))+
  #scale_fill_manual(values = color_vector)
  scale_fill_distiller(palette = "YlGnBu", direction = 1)+
  theme_bw()+
  theme(legend.position = "none",
        plot.title.position = "plot")

# Needed for the next question
# Save the order 
yes_data_order <- yes_data %>%
  filter(qname_main == "YD-1") %>%
  group_by(q_text) %>%
  summarize(cnt = n()) %>%
  mutate(percentage = round(cnt/num_resp_yes_data*100, 1)) %>% 
  select(q_text, percentage) %>% 
  arrange(desc(percentage))

q_text_order <- factor(yes_data_order$q_text, levels = yes_data_order$q_text)

```
There was an option "Other", to which there was one response: **LiDAR data**. 

---------------------------------------------------------------------------------

When comparing the datasets respondents would like to access (regardless whether they can or have - section 2.3) and the datasets they have actually accessed, there is a clear discrepancy, see figure below.

```{r comparison, fig.width = 8, fig.height = 4, echo = FALSE, warning = FALSE, message = FALSE}
wants_access <- intro %>%
  filter(ID %in% unique(yes_data$ID), str_detect(qname, "D-3")) %>%
  group_by(q_text, order) %>%
  summarize(cnt = n()) %>%
  mutate(percentage = round(cnt/num_resp_yes_data*100, 1)) %>% 
  group_by(q_text) %>% 
  mutate(tot_perc = sum(percentage), ave_score = sum(order*cnt)/sum(cnt)) %>% 
  select(q_text, tot_perc) %>% 
  distinct()

has_access <- yes_data %>% 
  filter(qname_main == "YD-1") %>% 
  group_by(q_text) %>%
  summarize(cnt = n()) %>%
  mutate(percentage = round(cnt/num_resp_yes_data*100, 1)) %>% 
  select(q_text, percentage)

access_summ <- full_join(wants_access, has_access) %>% 
  mutate(q_text = factor(q_text, levels = q_text_order),
         diff = tot_perc - percentage)

ggplot(access_summ, aes(x = diff, y = fct_rev(q_text), fill = q_text))+
  geom_col(color = "darkgrey")+
  labs(x = "Difference between the percentage of respondents that\nwould like to access these data and those that actually have",
       y = "")+
  scale_fill_manual(values = color_vector)+
  theme_bw()+
  theme(legend.position = "none")

```

While not mapped 1:1 for each respondent, from the figure it appears that for almost all data (aside from water quality information, and "Other") 22.5 - 30% of respondents have not accessed or are not accessing data they would like to access.

---------------------------------------------------------------------------------

The following table summarizes the detailed questions per dataset. The numbers represent the percentage of respondents that chose that answer. Questions that allowed multiple answers are indicated in the table with an asterisk, \* : these percentages can add up to more than 100%.

***Re-assess colors? The black text on dark blue is not well-readable.***


```{r access_detail_table, echo = FALSE, warning = FALSE, message = FALSE}
# Change 'other' to LiDAR
levels(q_text_order)[which(q_text_order == "Other (please specify)")] <- "LiDAR"

# Get number of respondents for each dataset and each question (because some people
# stopped answering questions halfway in!)
yes_data2 <- yes_data %>%
  filter(qname_main != "YD-1") %>%
  group_by(main, field_name) %>%
  summarize(tot_cnt = length(unique(ID))) %>% 
  #summarize(tot_cnt = n()) %>% 
  #rename(field_name = q_text) %>% 
  right_join(yes_data)

# Reorganize data for kable table

yes_data_table <- yes_data2 %>% 
  # Create summary (percentages) based on the dataset (field_name), question and answer
  filter(qname_main != "YD-1") %>% 
  group_by(field_name, main, q_text, tot_cnt) %>% # tot_cnt
  summarize(cnt = n()) %>%
  mutate(percentage = round(cnt/tot_cnt*100, 1)) %>% 
  select(-cnt, -tot_cnt) %>% 
  ungroup() %>% 
  group_by(field_name, main) %>% 
  pivot_wider(names_from = field_name, values_from = percentage, values_fill = 0) %>%
  rename(LiDAR = `Other (please specify)`) %>%
  select(q_text, q_text_order) %>% # order datasets (columns) as per the previous ranking
  left_join(select(yes_data, main, qname_main)) %>% 
  distinct() %>% 
  arrange(qname_main) %>% 
  ungroup() %>% 
  #rename(LiDAR = `Other (please specify)`) %>% 
  select(-qname_main) 

#### In order to have the answers show up correctly, I first order everything by
# the percentages in the wq column (have to pick something)
yes_data_table <- yes_data_table %>% 
  mutate(main = fct_inorder(main)) %>% 
  group_by(main) %>% 
  arrange(desc(`Water quality information (including nutrients and algae)`),
          .by_group = TRUE)

# Take the whole column q_text, make factors and re-level the ones for the 2
# questions with a specific order of the answers
yes_data_table$q_text <- fct_inorder(yes_data_table$q_text)
# Check:
# levels(yes_data_table$q_text)
levels(yes_data_table$q_text)[15:21] <- c("Daily", "At least once a week", "2-3 times a month", "Once a month", "Once every 6 months", "Once every year", "Less than once a year")
levels(yes_data_table$q_text)[27:30] <- c("Slightly well", "Moderately well", "Very well", "Extremely well")

# Loop through columns and apply colors to be used in the kable table
for (i in 3:10) {
  col_name <- names(yes_data_table)[i]
  col_index <- which(names(yes_data_table) == col_name)
  color <- color_vector[col_index-2]
  yes_data_table[[col_name]] <- color_tile("white", color)(yes_data_table[[col_name]])
} 

# # Add the number of observations as a first row
# yes_data2_summary <- yes_data2 %>% 
#   select(field_name, tot_cnt) %>% 
#   #filter(!duplicated(.), !is.na(field_name)) %>% 
#   pivot_wider(names_from = field_name, values_from = tot_cnt) %>% 
#   rename(LiDAR = `Other (please specify)`) %>% 
#   select(q_text_order)
# 
# yes_data2_summary <- tibble(main = "Number of respondents", q_text = "N =", yes_data2_summary)
# 
# # The following is very "hackey" because I am pretty sure that is not how you're
# # supposed to use color_tile (I made the gradient white to white), but it works...
# for (i in 3:10) {
#   col_name <- names(yes_data2_summary)[i]
#   col_index <- which(names(yes_data2_summary) == col_name)
#   color <- color_vector[col_index-2]
#   yes_data2_summary[[col_name]] <- color_tile("white", "white")(yes_data2_summary[[col_name]])
# }
# 
# yes_data_table <- full_join(yes_data2_summary, yes_data_table)

# Create table to pack rows dynamically
tbl_headers <- table(fct_inorder(yes_data_table$main))
names(tbl_headers) <- c("How do you most frequently obtain or access these data?",
                        "What are the advantages of this primary method of accessing or obtaining these data?*",
                        "What are the disadvantages of the primary method of accessing or obtaining these data?*",
                        "How often do/did you access or obtain these data?",
                        "What do you typically use these data for?*",
                        "How well do these data generally satisfy your need(s)?")

# Create kable table
yes_data_table %>% 
  rename(Question = q_text) %>% 
  ungroup() %>% 
  select(-main) %>% 
  kbl(escape = FALSE) %>% #col.names = c("", "")
  kable_minimal("striped") %>%
  pack_rows(index = tbl_headers) #%>% 
```

--------------------------------------------------------

***Maybe also add colors to the headers in the tables below? Haven't been able to figure out how yet.***

The tables below list the text answers that were provided by respondents to the "free text" questions above. These text answers are the original, unaltered responses. 

**The websites that respondents used to obtain data were:**

``` {r websites_table, echo = FALSE, warning = FALSE, message = FALSE}
# Read in text data results
txt_data_yes <- read_csv("../data_deidentified/subsets/data_yes_results_text.csv")

txt_data_yes_YD2_2 <- txt_data_yes %>% 
  filter(qname_main == "YD-2", q_code == 2) %>% 
  mutate(field_name = ifelse(field_name == "Other (please specify)", "LiDAR", field_name)) %>%
  mutate(field_name = factor(field_name, levels = q_text_order)) %>% 
  arrange(field_name) %>% 
  select(-main, -ID, -source, -qname, - field_no, -qname_main, -q_code, -q_text)

# Add colors to the headers? Maybe I have to do pack_rows manually, so I can
# set the colors for each...
  
txt_data_yes_YD2_2 %>% 
  kbl(col.names = c("", ""), escape = FALSE) %>% 
  remove_column(2) %>% 
  kable_minimal("striped", font_size = 12, full_width = FALSE) %>%
  #add_header_above(c("Websites accessed" = 1)) %>%
  pack_rows(index = table(fct_inorder(txt_data_yes_YD2_2$field_name))) 

```
The answers "CDMO" refer to the National Estuarine Research Reserve System Centralized Data Management Office: https://cdmo.baruch.sc.edu/

"SEACAR" is the Statewide Ecosystem Assessment of Coastal and Aquatic Resources by the Florida Department of Environmental Protection: https://data.florida-seacar.org/

"SWMP" is the NERR System-Wide Monitoring Program: https://coast.noaa.gov/digitalcoast/data/nerr.html

-------------------------------------------------------------------------------

**"Other" avenues for accessing data were:**

``` {r othersources_table, echo = FALSE, warning = FALSE, message = FALSE}
txt_data_yes_YD2_4 <- txt_data_yes %>% 
  filter(qname_main == "YD-2", q_code == 4) %>% 
  mutate(field_name = ifelse(field_name == "Other (please specify)", "LiDAR", field_name)) %>%
  mutate(field_name = factor(field_name, levels = q_text_order)) %>% 
  arrange(field_name) %>% 
  select(-main, -ID, -source, -qname, - field_no, -qname_main, -q_code, -q_text)

index_table <- table(fct_inorder(txt_data_yes_YD2_4$field_name))
index_table <- index_table[-which(index_table == 0)]

txt_data_yes_YD2_4 %>% 
  kbl(col.names = c("", ""), escape = FALSE) %>% 
  remove_column(2) %>% 
  kable_minimal("striped", font_size = 12, full_width = FALSE) %>%
  #add_header_above(c("Other ways of accessing data" = 1)) %>%
  pack_rows(index = index_table)

```

Some of these answers could fall under the option "Websites", but without downloading. Some notable options for people to access data are: state of the preserve presentations, internal databases (for employees), FWC (data has to be requested from FWC, it is generally not available on websites), calling the Visitor Center, personal observations, and the newsletter.

-------------------------------------------------------------------------------

**Advantages listed by respondents under "Other" were:**
(link to main way of getting data?)

``` {r otheradvantages_table, echo = FALSE, warning = FALSE, message = FALSE}
txt_data_yes_YD3 <- txt_data_yes %>% 
  filter(qname_main == "YD-3") %>% 
  mutate(field_name = ifelse(field_name == "Other (please specify)", "LiDAR", field_name)) %>%
  mutate(field_name = factor(field_name, levels = q_text_order)) %>% 
  arrange(field_name) %>%
  select(-main, -ID, -source, -qname, - field_no, -qname_main, -q_code, -q_text)

index_table <- table(fct_inorder(txt_data_yes_YD3$field_name))
index_table <- index_table[-which(index_table == 0)]

txt_data_yes_YD3 %>% 
  kbl(col.names = c("", ""), escape = FALSE) %>% 
  remove_column(2) %>% 
  kable_minimal("striped", font_size = 12, full_width = FALSE) %>%
  #add_header_above(c("Other advantages accessing data" = 1)) %>%
  pack_rows(index = index_table)
```

-------------------------------------------------------------------------------

**Disdvantages listed by respondents under "Other" were:**
 (link to main way of getting data?)

``` {r otherdisadvantages_table, echo = FALSE, warning = FALSE, message = FALSE}
txt_data_yes_YD4 <- txt_data_yes %>% 
  filter(qname_main == "YD-4") %>% 
  mutate(field_name = ifelse(field_name == "Other (please specify)", "LiDAR", field_name)) %>%
  mutate(field_name = factor(field_name, levels = q_text_order)) %>% 
  arrange(field_name) %>%
  select(-main, -ID, -source, -qname, - field_no, -qname_main, -q_code, -q_text)

index_table <- table(fct_inorder(txt_data_yes_YD4$field_name))
index_table <- index_table[-which(index_table == 0)]

txt_data_yes_YD4 %>% 
  kbl(col.names = c("", ""), escape = FALSE) %>% 
  remove_column(2) %>% 
  kable_minimal("striped", font_size = 12, full_width = FALSE) %>%
  #add_header_above(c("Other disadvantages accessing data" = 1)) %>%
  pack_rows(index = index_table)
```

While a large number of people indicated there were no disadvantages, the "free text" answers provide insight in some drawbacks people identified. The "Take home messages" box at the end of this section summarizes these.

-------------------------------------------------------------------------------

**In terms of usage of data, respondents added the following under "Other":**

``` {r otherusage_table, echo = FALSE, warning = FALSE, message = FALSE}
txt_data_yes_YD6 <- txt_data_yes %>% 
  filter(qname_main == "YD-6") %>% 
  mutate(field_name = ifelse(field_name == "Other (please specify)", "LiDAR", field_name)) %>%
  mutate(field_name = factor(field_name, levels = q_text_order)) %>% 
  arrange(field_name) %>%
  select(-main, -ID, -source, -qname, - field_no, -qname_main, -q_code, -q_text)

index_table <- table(fct_inorder(txt_data_yes_YD6$field_name))
index_table <- index_table[-which(index_table == 0)]

txt_data_yes_YD6 %>% 
  kbl(col.names = c("", ""), escape = FALSE) %>% 
  remove_column(2) %>% 
  kable_minimal("striped", font_size = 12, full_width = FALSE) %>%
  #add_header_above(c("Other data usage" = 1)) %>%
  pack_rows(index = index_table)
```

Generally, the three usages mentioned here most are personal use, volunteer activities, and management purposes (vegetation / invasive plants, prescribed fire). 

:::: {.infobox .info data-latex="{info}"}
**Take home messages**

- The majority of people that have accessed data before did so for **water quality information**: 85%.
- **Water level information** and **information on fish, shellfish or other aquatic organisms** were accessed by 55% of the respondents, and 45% had accessed **information on vegetation**. All the other datasets were accessed by fewer than 40% of respondents.
- Comparing this to the information on the data people *would like* to access (regardless of whether they have in the past or can do so), the number people that would like to access data on fish, shellfish, or other aquatic organisms, water levels, weather, vegetation, and terrestrial animals is larger than those who have actually accessed those data. Only for water quality data there is a small discrepancy between the number of people wanting to access those data, and the number who have.

------------------------------------------------------------------------------

- For the 4 most popular types of datasets (bolded above), the majority of respondents obtain these data by requesting it from GTMNERR staff (by email) and also the majority finds the way they access data easy and convenient. In addition, 35-55% find the format in which they get the data useful. While 40-45% of respondents say there are no disadvantages in accessing these datasets, these results show that GTMNERR staff probably spend considerable time providing these data (and do an excellent job!). 
- About 70 to 85% of people access these data at least once a month, with most more frequent than that.
- The majority of respondents use these data for research purposes, but a considerable number of people also use them for other purposes such as education or other work-related purposes (not research/education).
- For all these 4 data, 80 to 100% of respondents indicate that they satisfy their needs slightly to moderately well. 

------------------------------------------------------------------------------

- In contrast, the other 4 types of information (weather, reserve or trail closures, terrestrial animals and LiDAR) are mostly accessed through websites - but also here, respondents feel data access is easy / conventient, and the format is useful. 
- Also for these data, respondents feel that there are not many disadvantages, though they did highlight difficulty in accessing weather data (25%) and the time it takes to request information on terrestrial animals (42.9%).
- In terms frequency of accessing these data, most people either access these data once month (weather, and terrestrial animals) or daily (reserve and trail closures, and terrestrial animals).
- The usage of these data fairly evenly distributed across the options that were provided - as well as how well the data satisfied people's needs. 

------------------------------------------------------------------------------

Below are some highlights of the disadvantages of the current manner in which people access data:

- It would be easier if data was accessible online (not having to bother researchers or having to make phone calls) - but then for some data that *is* available online, they are hard to find and/or cumbersome to access or download;
- Data are not always up-to-date;
- Data are supplied in various formats;
- Not all datasets that people are interested in are available online;
- People have to go to various / multiple places (online) to gather data;
- Some data is not specifically for the Guana Estuary (e.g. water level and weather information).

::::

_______________________________________________________________

### 5. Dashboard preferences

The survey asked respondents about their preferences regarding dashboard features (type and format of information, data delivery mode) and how they would access the dashboard.

By "dashboard" we meant a user interface on a computer display that presents (up-to-date) information with visualization tools such as graphs, charts, and tables - in a dynamic and interactive way.

```{r dash_how, fig.width = 5, fig.height = 3, echo = FALSE, message = FALSE, fig.align = 'center'}
# Since not everyone finished the survey, check number of respondents
num_resp_db <- length(unique(dashboard$ID))

ggplot(dashboard %>% 
         filter(qname_main == "T-1") %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp_db*100, 1)),
       aes(y = reorder(q_text, percentage), 
           x = percentage, 
           fill = percentage))+
  geom_col(color = "darkgrey") +
  labs(y = "", x = paste0("Percentage of respondents (N = ", num_resp_db, ")"), 
       title = "How would you prefer to access data?",
       caption  = "NOTE: Respondents could pick more than 1 response") +
  scale_fill_distiller(palette = "BuPu", direction = 1)+
  theme_bw()+
  theme(legend.position = "none",
        plot.title.position = "plot")
```

--------------------------------------------------------

```{r dash_type, fig.width = 7, fig.height = 4, echo = FALSE, message = FALSE, fig.align = 'center'}
ggplot(dashboard %>% 
         filter(qname_main == "T-2") %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp_db*100, 1)),
       aes(y = reorder(q_text, percentage), 
           x = percentage, 
           fill = percentage))+
  geom_col(color = "darkgrey") +
  labs(y = "", x = paste0("Percentage of respondents (N = ", num_resp_db, ")"), 
       title = "What type of information do you prefer?",
       caption  = "NOTE: Respondents could pick more than 1 response") +
  scale_fill_distiller(palette = "BuPu", direction = 1)+
  scale_y_discrete(labels = function(x) str_wrap(x, width = 20))+
  theme_bw()+
  theme(legend.position = "none",
        plot.title.position = "plot")
```

The response in the category "Other" is **projections**.

--------------------------------------------------------

When asked about the form of information and the format of data delivery, respondents were also asked to rank their choices. They did not have to rank all options: only those they were interested in.

```{r dash_form, fig.width = 7, fig.height = 4, echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center'}
# There's a tie for 2 options, use the mean order to show them in the correct order
order_scores <- dashboard %>% 
         filter(qname_main == "T-3") %>% 
         group_by(q_text) %>%
         summarize(order_score = mean(order))
# Fix the not sure answer (it's 1, which is most important, but there is only
# one answer so this messes with the fig)
order_scores$order_score[which(order_scores$q_text == "Not sure")] <- 3

ggplot(dashboard %>% 
         filter(qname_main == "T-3") %>% 
         group_by(q_text, order) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp_db*100, 1)) %>% 
         left_join(order_scores),
       aes(y = reorder(q_text, order_score, decreasing = TRUE), 
           x = percentage, fill = fct_rev(factor(order))))+
  geom_col(color = "darkgrey") +
  labs(y = "", x = paste0("Percentage of respondents (N = ", num_resp_db, ")"), 
       title = "What form of information do you prefer?",
       caption  = "NOTE: Respondents could pick more than 1 response") +
  #scale_fill_viridis_d(option = "rocket", name = "Rank", direction = -1)+
  scale_fill_brewer(palette = "BuPu")+ 
  scale_y_discrete(labels = function(x) str_wrap(x, width = 30))+
  theme_bw()+
  theme(plot.title.position = "plot",
        legend.position = "top",
        legend.spacing.x = unit(0.5, 'cm'))+
  guides(fill = guide_legend(title = "Rank",
                             nrow = 1,
                             label.position = "bottom",
                             title.position = "left", title.vjust = 1,
                             reverse = TRUE))
```


--------------------------------------------------------

```{r dash_delivery, fig.width = 7, fig.height = 5, echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center'}
order_scores2 <- dashboard %>% 
         filter(qname_main == "T-4") %>% 
         group_by(q_text) %>%
         summarize(order_score = mean(order))

ggplot(dashboard %>% 
         filter(qname_main == "T-4") %>% 
         group_by(q_text, order) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp_db*100, 1)) %>% 
         group_by(q_text) %>% 
         mutate(ave_score = sum(order*cnt)/sum(cnt)),
       aes(y = reorder(q_text, ave_score, decreasing = TRUE), 
           x = percentage, fill = fct_rev(factor(order))))+
  geom_col(color = "darkgrey") +
  labs(y = "", x = paste0("Percentage of respondents (N = ", num_resp_db, ")"), 
       title = "What format of data delivery would suit your needs best?",
       caption  = "NOTE: Respondents could pick more than 1 response") +
  #scale_fill_viridis_d(option = "rocket", name = "Rank", direction = -1)+
  scale_y_discrete(labels = function(x) str_wrap(x, width = 30))+
  scale_fill_brewer(palette = "BuPu")+ #
  geom_text(aes(x = 95, y = q_text, label = round(ave_score, 2)), check_overlap = TRUE)+
  theme_bw()+
  theme(plot.title.position = "plot",
        legend.position = "top",
        legend.spacing.x = unit(0.5, 'cm'))+
  guides(fill = guide_legend(title = "Rank",
                             nrow = 1,
                             label.position = "bottom",
                             title.position = "left", title.vjust = 1,
                             reverse = TRUE))
```

:::: {.infobox .info data-latex="{info}"}
**Take home messages**

- The overwhelming majority of respondents prefer to access a data dashboard on their computer. Slightly less than 50% would (also) want to access it on a cellphone.
- The type of information respondents would like to access is firstly recent data (from the past year), chosen by almost 95% of respondents. In a shared second place (almost 90% each) came historical data and current data (from the past month). Data representing current conditions was also chosen by just over 70% of the respondents.
- In terms of providing aggregated data through the dashboard, an equal number of respondents is interested in data aggregated by location as well as for time periods. Aggregation by location is ranked slightly higher by most respondents (1.7 vs 1.8 for time periods; again, lower values indicate higher preference/higher ranking).
- A relatively large number of people are also interested in non-aggregated ("raw") data: almost 75%.
- All data delivery formats suggested in the survey were popular with the respondents. While data downloads did not get the most votes in absolute numbers, almost half of those who picked this format ranked it their number 1 format: it has the best (lowest) average ranking. Maps and figures were about equally popular, both in absolute numbers as well as rankings. And while online tables came in "last" place, more than 75% of people would like to see this data format. 

::::

___________________________________________________________

### 6. Characteristics of respondents

Finally, the survey requested demographic information from respondents. This helps the project team get a better understanding of the dashboard's target audience.

#### 6.1 Age and gender
```{r age, fig.width = 12, fig.height = 4, echo = FALSE, message = FALSE, fig.align = 'center'}

num_resp_dem <- length(unique(demogr$ID))

age <- ggplot(demogr %>% 
         filter(qname == "DE-2") %>% 
         group_by(q_text) %>%
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp_dem*100, 1)),
       aes(y = fct_rev(factor(q_text)), x = percentage, fill = percentage))+
  geom_col(color = "darkgrey") +
  scale_fill_distiller(palette = "GnBu", direction = 1)+
  labs(x = paste0("Percentage of respondents (N = ", num_resp_dem, ")"), 
       y = "", title = "What is your age group?") +
  theme_bw()+
  theme(legend.position = "none")

gender <- ggplot(demogr %>% 
  filter(qname == "DE-3") %>% 
  group_by(q_text) %>% 
  summarize(cnt = n()) %>%
  mutate(percentage = round(cnt/num_resp_dem*100, 1)),
       aes(x = factor(q_text), y = percentage, fill = factor(q_text)))+
  geom_col(color = "darkgrey", width = 0.5) +
  labs(x = "", y = paste0("Percentage of respondents (N = ", num_resp_dem, ")"), 
       title = "What is your gender?") +
  scale_y_continuous(position = "right")+
  scale_fill_manual(values = c("#7bccc4", "#43a2ca"))+
  theme_bw()+
  theme(legend.position = "none") 

plot_grid(age, gender, ncol = 2, align = "v")
```

----------------------------------------------------

#### 6.2 Distance from the Guana Estuary
``` {r distance, fig.width = 5, fig.height = 4, echo = FALSE, message = FALSE, fig.align = 'center'}
ggplot(demogr %>% 
         filter(qname == "DE-4") %>% 
         group_by(q_text) %>% 
         summarize(cnt = n()) %>%
         mutate(percentage = round(cnt/num_resp_dem*100, 1)),
       aes(y = q_text, x = percentage, fill = percentage))+
  geom_col(color = "darkgrey") +
  labs(x = paste0("Percentage of respondents (N = ", num_resp_dem, ")"), 
       y = "Driving distance (minutes)", 
       title = "How far are you from the Guana Estuary?") +
  scale_fill_distiller(palette = "GnBu", direction = 1)+
  theme_bw()+
  theme(plot.title.position = "plot", legend.position = "none")
```

:::: {.infobox .info data-latex="{info}"}
**Take home messages**

- Slightly more respondents were female (55%) than male (45%).
- Most respondents were 65 or over (32.5%), but the two age groups 35-44 and 45-54 combined made up 35% of the respondents: there is a balance between respondents that are retired and that are mid- to senior-level working professionals (we assume).
- Most people live 31-60 minutes driving distance away from the Guana Estuary, which (together with the 11-30 minute driving distance option) probably corresponds to the nearest towns (Ponte Vedra, St Augustine). Those two categories made up 67.5% of the responses, meaning that the majority of the respondents have strong local connections to the area. 30% of respondents live further away (greater than 60 minutes driving distance), which most likely represents (visiting) scientists.

::::

____________________________________________________

## Next steps

Based on this report (and previous workshops), the project team will develop dashboard design recommendations and considerations. Work is already underway on a draft dashboard, and the project team will be in touch before the end of September 2023 about further steps on these, and to inform you of upcoming participation and discussion opportunities.

To access the code that created this document, the survey result data, or jpg versions of the figures, go to https://github.com/GTMNERR-Science-Transfer/Survey-results. 

Suggestions and comments on this draft report are very welcome; please email Dr. Geraldine Klarenberg at gklarenberg@ufl.edu, or leave an "Issue" on the above linked GitHub repository.

